#!/usr/bin/env bash

first() {
    echo 'Running first'
}

second() {
    echo 'Running second'
}

third() {
    echo 'Running third'
}

mapfile -t functions < <(declare -F | cut -d ' ' -f3)

queue=()

for arg in "$@"; do
    case "$arg" in
        all)
            for func in "${functions[@]}"; do
                queue+=("$func")
            done
            ;;
        *)
            for func in "${functions[@]}"; do
                [ "$arg" = "$func" ] && queue+=("$func")
            done

            # echo "Undefined function: $arg" >&2
            # exit 1
            ;;
    esac
done

for func in "${queue[@]}"; do
    echo "==> $func"
    $func
done
