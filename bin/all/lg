#!/usr/bin/env bash

changes=$(git diff --name-only)

[ -z "$changes" ] && exit 0

echo "$changes" | fzf --keep-right --no-input \
    --exit-0 \
    --bind 'space:execute(git add {})+reload(git diff --name-only)'\
    --bind 'j:down,k:up' \
    --bind 'ctrl-d:preview-half-page-down' \
    --bind 'ctrl-u:preview-half-page-up' \
    --layout=reverse \
    --preview-window=right,80% \
    --preview 'git diff {} | delta'
