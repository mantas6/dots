#!/usr/bin/env bash
# Automate branch workflow

set -e

root=$(git rev-parse --git-dir)

msg=${1:-$(gum write --show-line-numbers --height=5 --placeholder 'Branch name')}
[ -z "$msg" ] && exit 1

printf '%s' "$msg" >"$root/glz-msg"

branch=${msg%% *}

if git show-ref --verify --quiet "refs/heads/$branch"; then
	git checkout "$branch"
else
	git checkout -b "$branch"
fi
