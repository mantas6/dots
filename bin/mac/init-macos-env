#!/usr/bin/env sh

[ "$(uname)" != 'Darwin' ] && exit 1

export XDG_CONFIG_HOME="$HOME/.config"

if [ ! -x "$(command -v php)" ]; then
    /bin/bash -c "$(curl -fsSL https://php.new/install/mac/8.4)"
fi

if [ ! -x "$(command -v node)" ]; then
    (
        export NVM_DIR="$HOME/.local/share/nvm"

        git clone https://github.com/nvm-sh/nvm.git "$NVM_DIR"

        cd "$NVM_DIR" || exit 1
        # git checkout v0.40.3

        \. "$NVM_DIR/nvm.sh"
        nvm install node
        nvm use node
    )
fi

# https://macos-defaults.com

defaults write -g InitialKeyRepeat -int 15
defaults write -g KeyRepeat -int 1

defaults write NSGlobalDomain NSAutomaticSpellingCorrectionEnabled -bool false

defaults write -g NSWindowShouldDragOnGesture -bool true
defaults write com.apple.dock expose-group-apps -bool true
defaults write com.apple.spaces spans-displays -bool true
defaults write -g NSAutomaticWindowAnimationsEnabled -bool false

defaults write com.apple.dock show-recents -bool false

defaults write com.apple.Safari ShowFullURLInSmartSearchField -bool true
defaults write com.apple.finder _FXSortFoldersFirst -bool true
defaults write com.apple.finder ShowPathbar -bool true
defaults write -g com.apple.sound.uiaudio.enabled -int 0

defaults write com.apple.dock autohide -bool true
# defaults write NSGlobalDomain _HIHideMenuBar -bool true

# Get and set later:
# defaults read NSGlobalDomain com.apple.mouse.scaling
# defaults write NSGlobalDomain com.apple.mouse.scaling -float "4"
#
# defaults read com.apple.dock autohide-delay
# defaults write com.apple.Dock autohide-delay -float "0.7"
#
# defaults read NSGlobalDomain com.apple.trackpad.scaling
# defaults write NSGlobalDomain com.apple.trackpad.scaling -float "4"

killall SystemUIServer
killall Dock
killall Finder
